<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>Baidu Cloud Engine JavaScript SDK</title><meta name="viewport" content="width=device-width"><link rel="stylesheet" href="/bce-sdk-js/css/draft.css"><script type="text/javascript" src="//use.typekit.net/vqa1hcx.js"></script><script type="text/javascript">try{Typekit.load();}catch(e){}</script></head><body><div class="container"><div class="nav-main"><div class="wrap"><a class="nav-home" href="/bce-sdk-js/">bce-sdk-js</a><ul class="nav-site"><li><a href="/bce-sdk-js/docs/overview.html#content" class="active">文档</a></li><li><a href="http://github.com/baidubce/bce-sdk-js" class="">源码</a></li><li><a href="https://bce.baidu.com/index.html" class="">百度开放云</a></li></ul></div></div><section class="content wrap documentationContent"><div class="nav-docs"><div class="nav-docs-section"><h3>Quick Start</h3><ul><li><a style="margin-left:0;" class="" href="/bce-sdk-js/docs/overview.html#content">总览</a></li><li><a style="margin-left:0;" class="" href="/bce-sdk-js/docs/quickstart-env-nodejs.html#content">Nodejs环境</a></li><li><a style="margin-left:0;" class="" href="/bce-sdk-js/docs/quickstart-env-browser.html#content">浏览器环境</a></li></ul></div><div class="nav-docs-section"><h3>Advanced Topics</h3><ul><li><a style="margin-left:0;" class="" href="/bce-sdk-js/docs/advanced-topics-basic-example-in-browser.html#content">在浏览器中直接上传文件到bos</a></li><li><a style="margin-left:0;" class="" href="/bce-sdk-js/docs/advanced-topics-security-issue.html#content">AK和SK的安全性问题</a></li><li><a style="margin-left:0;" class="" href="/bce-sdk-js/docs/advanced-topics-server-signature.html#content">服务端签名</a></li><li><a style="margin-left:0;" class="" href="/bce-sdk-js/docs/advanced-topics-sts.html#content">STS临时认证</a></li><li><a style="margin-left:0;" class="" href="/bce-sdk-js/docs/advanced-topics-multiupload.html#content">大文件分块上传</a></li><li><a style="margin-left:0;" class="" href="/bce-sdk-js/docs/advanced-topics-resume.html#content">分块上传进阶 - “断点续传”</a></li><li><a style="margin-left:0;" class="" href="/bce-sdk-js/docs/advanced-topics-uploader.html#content">bce bos uploader</a></li><li><a style="margin-left:0;" class="" href="/bce-sdk-js/docs/advanced-topics-programming-style.html#content">多种异步编程风格</a></li><li><a style="margin-left:0;" class="active" href="/bce-sdk-js/docs/advanced-topics-postobject.html#content">IE低版本的处理</a></li></ul></div><div class="nav-docs-section"><h3>API Reference</h3><ul><li><a style="margin-left:0;" class="" href="/bce-sdk-js/docs/api-reference-bos.html#content">BOS - api</a></li><li><a style="margin-left:0;" class="" href="/bce-sdk-js/docs/api-reference-vod.html#content">VOD - api</a></li></ul></div></div><div class="inner-content"><a id="content"></a><h1>IE低版本的处理</h1><div><p>因为 IE低版本（IE8, IE9）对 html5 支持的不完善，为了在这些浏览器里面实现文件直传的功能，
BOS 开发了 PostObject 接口，通过一个 multipart/form-data 的格式，就可以把文件上传到 BOS 服务器。</p><p>我们已经在 <a href="http://leeight.github.io/bce-bos-uploader/" target="_blank">bce-bos-uploader</a> 实现了对这个接口的支持，使用
之前需要进行额外的配置工作：</p><ol><li>上传 crossdomain.xml</li><li>升级服务端计算签名的代码（Node.js 和 C#）</li><li>升级 bce-bos-uploader</li><li>通过条件注释引用 polyfills 文件</li></ol><h3><a class="anchor" name="%E4%B8%8A%E4%BC%A0%20crossdomain.xml"></a>上传 crossdomain.xml <a class="hash-link" href="#%E4%B8%8A%E4%BC%A0%20crossdomain.xml">#</a></h3><p>基于html5的跨域方案，我们需要设置 cors；如果通过 flash 来完成跨域数据交互的话，需要设置 crossdomain.xml，可以直接把
如下内容保存为 <code>crossdomain.xml</code>，然后上传到 <code>bucket</code> 的根目录：</p><pre class="prism language-javascript">

&lt;<span class="token operator">?</span>xml version<span class="token operator">=</span><span class="token string">&quot;1.0&quot;</span><span class="token operator">?</span><span class="token operator">&gt;</span>
&lt;<span class="token operator">!</span>DOCTYPE cross<span class="token operator">-</span>domain<span class="token operator">-</span>policy SYSTEM
<span class="token string">&quot;http://www.macromedia.com/xml/dtds/cross-domain-policy.dtd&quot;</span><span class="token operator">&gt;</span>
&lt;cross<span class="token operator">-</span>domain<span class="token operator">-</span>policy<span class="token operator">&gt;</span>
  &lt;allow<span class="token operator">-</span>access<span class="token operator">-</span>from domain<span class="token operator">=</span><span class="token string">&quot;*&quot;</span> secure<span class="token operator">=</span><span class="token string">&quot;false&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
&lt;<span class="token operator">/</span>cross<span class="token operator">-</span>domain<span class="token operator">-</span>policy<span class="token operator">&gt;</span></pre><h3><a class="anchor" name="%E5%8D%87%E7%BA%A7%E6%9C%8D%E5%8A%A1%E7%AB%AF%E8%AE%A1%E7%AE%97%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BB%A3%E7%A0%81"></a>升级服务端计算签名的代码 <a class="hash-link" href="#%E5%8D%87%E7%BA%A7%E6%9C%8D%E5%8A%A1%E7%AB%AF%E8%AE%A1%E7%AE%97%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BB%A3%E7%A0%81">#</a></h3><p>请参考<a href="advanced-topics-server-signature" target="_blank">服务端动态签名</a></p><h3><a class="anchor" name="%E5%8D%87%E7%BA%A7%20bce-bos-uploader"></a>升级 bce-bos-uploader <a class="hash-link" href="#%E5%8D%87%E7%BA%A7%20bce-bos-uploader">#</a></h3><p>通过 bower 安装最新的 bce-bos-uploader</p><pre class="prism language-javascript">
bower install bce<span class="token operator">-</span>bos<span class="token operator">-</span>uploader#<span class="token number">1.1</span><span class="token punctuation">.</span><span class="token number">5</span><span class="token operator">-</span>rc<span class="token number">.1</span></pre><h3><a class="anchor" name="%E9%80%9A%E8%BF%87%E6%9D%A1%E4%BB%B6%E6%B3%A8%E9%87%8A%E5%BC%95%E7%94%A8%20polyfills%20%E6%96%87%E4%BB%B6"></a>通过条件注释引用 polyfills 文件 <a class="hash-link" href="#%E9%80%9A%E8%BF%87%E6%9D%A1%E4%BB%B6%E6%B3%A8%E9%87%8A%E5%BC%95%E7%94%A8%20polyfills%20%E6%96%87%E4%BB%B6">#</a></h3><p>因为低版本的IE对 es5 的一些特性支持的不完善，所以需要引入 polyfills 文件来处理一下。</p><pre class="prism language-javascript">
&lt;<span class="token operator">!</span><span class="token operator">--</span><span class="token punctuation">[</span><span class="token keyword">if</span> lt IE <span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">&gt;</span>&lt;script src<span class="token operator">=</span><span class="token string">&quot;bower_components/js-polyfills/es5.js&quot;</span><span class="token operator">&gt;</span>&lt;<span class="token operator">/</span>script<span class="token operator">&gt;</span>&lt;<span class="token operator">!</span><span class="token punctuation">[</span>endif<span class="token punctuation">]</span><span class="token operator">--</span><span class="token operator">&gt;</span>
&lt;<span class="token operator">!</span><span class="token operator">--</span><span class="token punctuation">[</span><span class="token keyword">if</span> lt IE <span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">&gt;</span>&lt;script src<span class="token operator">=</span><span class="token string">&quot;bower_components/moxie/bin/js/moxie.min.js&quot;</span><span class="token operator">&gt;</span>&lt;<span class="token operator">/</span>script<span class="token operator">&gt;</span>&lt;<span class="token operator">!</span><span class="token punctuation">[</span>endif<span class="token punctuation">]</span><span class="token operator">--</span><span class="token operator">&gt;</span></pre><p>然后在初始化 <code>baidubce.bos.Uploader</code> 的时候，设置一下 <code>flash_swf_url</code> 即可：</p><pre class="prism language-javascript">
<span class="token keyword">var</span> uploader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">baidubce<span class="token punctuation">.</span>bos<span class="token punctuation">.</span>Uploader</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    flash_swf_url<span class="token punctuation">:</span> <span class="token string">&#x27;bower_components/moxie/bin/flash/Moxie.swf&#x27;</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></div><div class="docs-prevnext"><a class="docs-next" href="api-reference-bos.html#content">下一篇 →</a></div></div></section><footer class="wrap"><div class="right">© 2016 Baidu Inc.</div></footer></div></body></html>